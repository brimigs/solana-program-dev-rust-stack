---
title: Reference
description: Advanced features, configuration, and troubleshooting
---

# Reference

Advanced features and detailed configuration options.

## Configuration

### Custom Compute Budget

```rust
use litesvm::LiteSVM;
use solana_program_runtime::compute_budget::ComputeBudget;

let mut svm = LiteSVM::default()
    .with_compute_budget(ComputeBudget {
        compute_unit_limit: 1_400_000,
        heap_size: 256 * 1024, // 256KB
        stack_frame_size: 4096,
        log_pubkey_units: 100,
        ..ComputeBudget::default()
    });
```

### Disable Security Features

```rust
let mut svm = LiteSVM::default()
    .with_sigverify(false)       // Skip signature verification
    .with_blockhash_check(false) // Skip blockhash validation
    .with_transaction_history(100); // Keep last 100 transactions
```

### Initial Setup

```rust
let mut svm = LiteSVM::default()
    .with_lamports(10_000_000_000_000); // Initial lamports for fees
```

## Advanced Methods

### get_sysvar / set_sysvar

Manipulate system variables directly.

```rust
use solana_sdk::clock::Clock;

// Get current clock
let mut clock: Clock = svm.get_sysvar();

// Modify
clock.slot = 1000;
clock.unix_timestamp = 1735689600;
clock.epoch = 10;

// Set back
svm.set_sysvar(&clock);
```

### set_account

Create arbitrary account states.

```rust
use solana_sdk::account::Account;

svm.set_account(pubkey, Account {
    lamports: 2_039_280,
    data: vec![0; 100],
    owner: program_id,
    executable: false,
    rent_epoch: 0,
}).unwrap();
```

### get_transaction

Access transaction history.

```rust
use solana_sdk::signature::Signature;

if let Some(tx_result) = svm.get_transaction(&signature) {
    match tx_result {
        Ok(meta) => println!("Found: {:?}", meta.logs),
        Err(e) => println!("Failed: {:?}", e),
    }
}
```

### expire_blockhash

Force blockhash expiration.

```rust
let old_blockhash = svm.latest_blockhash();
svm.expire_blockhash();
let new_blockhash = svm.latest_blockhash();
assert_ne!(old_blockhash, new_blockhash);
```

### add_program_from_file

Deploy from file path.

```rust
svm.add_program_from_file(
    program_id,
    "path/to/program.so"
).unwrap();
```

## Time Travel

### Clock Manipulation

```rust
use solana_sdk::clock::Clock;

let mut clock: Clock = svm.get_sysvar();
clock.unix_timestamp = 1735689600; // Jan 1, 2025
clock.slot = 1000;
clock.epoch = 10;
svm.set_sysvar(&clock);
```

### Slot Warping

```rust
svm.warp_to_slot(5000);
```

## Custom Sysvars

### Rent

```rust
use solana_sdk::rent::Rent;

let rent = Rent {
    lamports_per_byte_year: 3480,
    exemption_threshold: 2.0,
    burn_percent: 50,
};
svm.set_sysvar(&rent);
```

### Epoch Schedule

```rust
use solana_sdk::epoch_schedule::EpochSchedule;

let epoch_schedule = EpochSchedule {
    slots_per_epoch: 432_000,
    leader_schedule_slot_offset: 432_000,
    warmup: false,
    first_normal_epoch: 0,
    first_normal_slot: 0,
};
svm.set_sysvar(&epoch_schedule);
```

## SPL Token Support

Add to Cargo.toml:
```toml
[dev-dependencies]
litesvm-token = "0.2.0"
```

Create token accounts:
```rust
use spl_token::state::{Account as TokenAccount, AccountState};
use solana_program::program_option::COption;
use solana_program::program_pack::Pack;

let token_account = TokenAccount {
    mint,
    owner,
    amount: 1_000_000_000_000,
    delegate: COption::None,
    state: AccountState::Initialized,
    is_native: COption::None,
    delegated_amount: 0,
    close_authority: COption::None,
};

let mut data = vec![0u8; TokenAccount::LEN];
TokenAccount::pack(token_account, &mut data).unwrap();

svm.set_account(token_account_key, Account {
    lamports: 2_039_280,
    data,
    owner: spl_token::id(),
    executable: false,
    rent_epoch: 0,
}).unwrap();
```

## Troubleshooting

### Common Errors

| Error | Solution |
|-------|----------|
| `ProgramAccountNotFound` | Call `svm.add_program()` before transaction |
| `BlockhashNotFound` | Use `svm.latest_blockhash()` |
| `InsufficientFundsForFee` | Call `svm.airdrop()` first |
| `AccountNotFound` | Create with `svm.set_account()` |
| `ComputeBudgetExceeded` | Increase with `.with_compute_budget()` |

### Debug Transaction Logs

```rust
match svm.send_transaction(tx) {
    Ok(meta) => {
        for log in &meta.logs {
            if log.starts_with("Program log:") {
                println!("Program: {}", &log[13..]);
            }
        }
    }
    Err(e) => {
        println!("Error: {:?}", e.err);
        println!("Logs: {:?}", e.meta.logs);
    }
}
```

## Performance Tips

1. **Use include_bytes!** - Compile programs into binary
   ```rust
   let bytes = include_bytes!("../target/deploy/program.so");
   ```

2. **Disable security for tests**
   ```rust
   let mut svm = LiteSVM::default().with_sigverify(false);
   ```

3. **Reuse SVM instances**
   ```rust
   fn setup() -> LiteSVM {
       let mut svm = LiteSVM::new();
       // Common setup
       svm
   }
   ```

4. **Use simulate for read-only**
   ```rust
   let result = svm.simulate_transaction(tx);
   // State unchanged
   ```

## Built-in Programs

LiteSVM includes these programs by default:

- System Program
- BPF Loader (v1, v2, v3)
- Vote Program  
- Stake Program
- Config Program
- SPL Token
- SPL Token 2022
- SPL Associated Token Account
- SPL Memo

## Pulling Programs from Clusters

```bash
# From mainnet
solana program dump <PROGRAM_ID> program.so --url mainnet-beta

# From devnet  
solana program dump <PROGRAM_ID> program.so --url devnet
```

Then in tests:
```rust
svm.add_program_from_file(program_id, "program.so").unwrap();
```

## Common Program IDs

```rust
// Pyth Oracle (Devnet)
const PYTH: &str = "gSbePebfvPy7tRqimPoVecS2UsBvYv46ynrzWocc92s";

// Metaplex Token Metadata
const METADATA: &str = "metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s";

// OpenBook DEX
const OPENBOOK: &str = "srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX";
```

## Links

- [GitHub Repository](https://github.com/LiteSVM/litesvm)
- [Crates.io Package](https://crates.io/crates/litesvm)
- [Issue Tracker](https://github.com/LiteSVM/litesvm/issues)
- [Rust Docs](https://docs.rs/litesvm)