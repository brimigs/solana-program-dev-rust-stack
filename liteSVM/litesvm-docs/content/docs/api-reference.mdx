---
title: API Reference
description: The essential LiteSVM methods you need to know
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';

# API Reference

The 6 essential methods that cover 90% of your testing needs.

## Quick Reference

| Method | Purpose | Returns |
|--------|---------|---------|
| `new()` | Create test environment | `LiteSVM` |
| `airdrop()` | Fund accounts with SOL | `Result<()>` |
| `add_program()` | Deploy a program | `Result<()>` |
| `send_transaction()` | Execute transaction | `Result<TransactionMetadata>` |
| `get_balance()` | Check account balance | `Option<u64>` |
| `get_account()` | Get full account data | `Option<Account>` |

## Setup Methods

### `LiteSVM::new()`

Creates a new test environment with sensible defaults.

```rust
let mut svm = LiteSVM::new();
```

**What it includes:**
- All native programs (System, BPF Loader, etc.)
- Default sysvars (Clock, Rent, etc.)
- Compute budget of 200,000 units
- Feature set matching mainnet

<Callout type="tip">
  For custom configuration, use `LiteSVM::default()` with builder methods.
</Callout>

## Funding Methods

### `airdrop()`

Instantly funds any account with SOL.

```rust
svm.airdrop(&pubkey, lamports)?;
```

<Tabs items={['Basic Usage', 'Common Amounts', 'Multiple Accounts']}>
<Tab value="Basic Usage">
```rust
let user = Keypair::new();
svm.airdrop(&user.pubkey(), 1_000_000_000)?; // 1 SOL
```
</Tab>
<Tab value="Common Amounts">
```rust
// Common amounts for testing
svm.airdrop(&user.pubkey(), 1)?;                    // 1 lamport
svm.airdrop(&user.pubkey(), 1_000_000)?;           // 0.001 SOL  
svm.airdrop(&user.pubkey(), 1_000_000_000)?;       // 1 SOL
svm.airdrop(&user.pubkey(), 10_000_000_000)?;      // 10 SOL
```
</Tab>
<Tab value="Multiple Accounts">
```rust
// Fund multiple accounts
let accounts = vec![Keypair::new(), Keypair::new(), Keypair::new()];
for account in &accounts {
    svm.airdrop(&account.pubkey(), 1_000_000_000)?;
}
```
</Tab>
</Tabs>

## Program Methods

### `add_program()`

Deploys a program to the test environment.

```rust
svm.add_program(program_id, &bytes)?;
```

<Tabs items={['From Bytes', 'From File', 'Include at Compile']}>
<Tab value="From Bytes">
```rust
let program_id = Pubkey::new_unique();
let bytes = get_program_bytes();
svm.add_program(program_id, &bytes)?;
```
</Tab>
<Tab value="From File">
```rust
let program_id = Pubkey::new_unique();
let bytes = std::fs::read("target/deploy/program.so")?;
svm.add_program(program_id, &bytes)?;
```
</Tab>
<Tab value="Include at Compile">
```rust
// Best for tests - no runtime I/O
let program_id = Pubkey::new_unique();
let bytes = include_bytes!("../target/deploy/program.so");
svm.add_program(program_id, bytes)?;
```
</Tab>
</Tabs>

<Callout>
  Programs are immediately available after `add_program()` - no deployment transaction needed.
</Callout>

## Transaction Methods

### `send_transaction()`

Executes a transaction and returns detailed results.

```rust
let result = svm.send_transaction(tx)?;
```

**Returns `TransactionMetadata`:**
```rust
pub struct TransactionMetadata {
    pub compute_units_consumed: u64,  // How many CUs used
    pub logs: Vec<String>,            // Program logs
    pub return_data: (Pubkey, Vec<u8>), // Return data if any
}
```

**Example with error handling:**
```rust
match svm.send_transaction(tx) {
    Ok(meta) => {
        println!("Success! Used {} CUs", meta.compute_units_consumed);
        println!("Logs: {:?}", meta.logs);
    }
    Err(e) => {
        println!("Failed: {:?}", e.err);
        println!("Logs before error: {:?}", e.meta.logs);
    }
}
```

## State Methods

### `get_balance()`

Returns account balance in lamports.

```rust
let balance = svm.get_balance(&pubkey)?;
```

**Common usage:**
```rust
// Check if account exists and has funds
if let Some(balance) = svm.get_balance(&pubkey) {
    println!("Balance: {} SOL", balance as f64 / 1e9);
} else {
    println!("Account doesn't exist");
}
```

### `get_account()`

Returns full account data.

```rust
let account = svm.get_account(&pubkey);
```

**Returns `Account`:**
```rust
pub struct Account {
    pub lamports: u64,        // Balance
    pub data: Vec<u8>,        // Account data
    pub owner: Pubkey,        // Program that owns this account
    pub executable: bool,     // Is this a program?
    pub rent_epoch: u64,      // Rent collection epoch
}
```

**Example - Reading token account:**
```rust
use spl_token::state::Account as TokenAccount;

if let Some(account) = svm.get_account(&token_account_pubkey) {
    let token_account = TokenAccount::unpack(&account.data)?;
    println!("Token balance: {}", token_account.amount);
    println!("Token owner: {}", token_account.owner);
}
```

## Advanced Methods

### `set_account()`

Directly set any account state (testing only).

```rust
svm.set_account(pubkey, account)?;
```

**Example - Create pre-funded token account:**
```rust
use spl_token::state::{Account as TokenAccount, AccountState};

let token_account = TokenAccount {
    mint,
    owner,
    amount: 1_000_000,
    state: AccountState::Initialized,
    // ... other fields
};

let mut data = vec![0u8; TokenAccount::LEN];
TokenAccount::pack(token_account, &mut data)?;

svm.set_account(token_pubkey, Account {
    lamports: 2_039_280,  // Rent-exempt amount
    data,
    owner: spl_token::id(),
    executable: false,
    rent_epoch: 0,
})?;
```

### `warp_to_slot()`

Jump to any slot instantly.

```rust
svm.warp_to_slot(1000);
```

### `latest_blockhash()`

Get the current blockhash for transactions.

```rust
let blockhash = svm.latest_blockhash();
```

## Common Patterns

### Transaction Building Pattern
```rust
let tx = Transaction::new_signed_with_payer(
    &[instruction],
    Some(&payer.pubkey()),
    &[&payer],
    svm.latest_blockhash(),
);
```

### Error Checking Pattern
```rust
let result = svm.send_transaction(tx);
assert!(result.is_err());
assert_eq!(
    result.unwrap_err().err,
    TransactionError::InsufficientFunds
);
```

### Balance Assertion Pattern
```rust
let before = svm.get_balance(&account).unwrap_or(0);
svm.send_transaction(tx)?;
let after = svm.get_balance(&account).unwrap_or(0);
assert_eq!(after - before, expected_change);
```

## Next Steps

- **[Examples →](/docs/examples)** - See these methods in action
- **[Advanced →](/docs/advanced)** - Deep dive into configuration